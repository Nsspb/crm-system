{"ast":null,"code":"import _regeneratorRuntime from\"/home/boss/Desktop/crm/social/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/boss/Desktop/crm/social/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/boss/Desktop/crm/social/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./post.css';import{MoreVert}from'@mui/icons-material';import{useContext,useEffect,useState}from'react';import axios from'axios';import{format}from\"timeago.js\";import{AuthContext}from\"../../context/AuthContext\";import{Link}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Post(_ref){var post=_ref.post;var _useState=useState(post.likes.length),_useState2=_slicedToArray(_useState,2),like=_useState2[0],setLike=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLiked=_useState4[0],setIsLiked=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),user=_useState6[0],setUser=_useState6[1];var PF=process.env.REACT_APP_PUBLIC_FOLDER;var _useContext=useContext(AuthContext),currentUser=_useContext.user;useEffect(function(){setIsLiked(post.likes.includes(currentUser._id));},[currentUser._id,post.likes]);useEffect(function(){var fetchUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/users?userId=\".concat(post.userId));case 2:res=_context.sent;setUser(res.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return function fetchUser(){return _ref2.apply(this,arguments);};}();fetchUser();},[post.userId]);var likeHandler=function likeHandler(){try{axios.put(\"/posts/\"+post._id+\"/like\",{userId:currentUser._id});}catch(err){}setLike(isLiked?like-1:like+1);setIsLiked(!isLiked);};return/*#__PURE__*/_jsx(\"div\",{className:\"post\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"postWrapper\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"postTop\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"postTopLeft\",children:[/*#__PURE__*/_jsx(Link,{to:\"/profile/\".concat(user.username),children:/*#__PURE__*/_jsx(\"img\",{className:\"postProfileImg\",src:user.profilePicture?PF+user.profilePicture:PF+\"person/noAvatar.png\",alt:\"\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"postUsername\",children:user.username}),/*#__PURE__*/_jsx(\"span\",{className:\"postDate\",children:format(post.createdAt)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"postTopRight\",children:/*#__PURE__*/_jsx(MoreVert,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"postCenter\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"postText\",children:post===null||post===void 0?void 0:post.desc}),/*#__PURE__*/_jsx(\"img\",{className:\"postImg\",src:PF+post.img,alt:\"\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"postBottom\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"postBottomLeft\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"likeIcon\",src:\"\".concat(PF,\"like.png\"),onClick:likeHandler,alt:\"\"}),/*#__PURE__*/_jsx(\"img\",{className:\"likeIcon\",src:\"\".concat(PF,\"heart.png\"),onClick:likeHandler,alt:\"\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"postLikeCounter\",children:[like,\" people like it\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"postBottomRight\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"postCommentText\",children:[post.comment,\" comments\"]})})]})]})});}","map":{"version":3,"sources":["/home/boss/Desktop/crm/social/client/src/components/post/Post.jsx"],"names":["MoreVert","useContext","useEffect","useState","axios","format","AuthContext","Link","Post","post","likes","length","like","setLike","isLiked","setIsLiked","user","setUser","PF","process","env","REACT_APP_PUBLIC_FOLDER","currentUser","includes","_id","fetchUser","get","userId","res","data","likeHandler","put","err","username","profilePicture","createdAt","desc","img","comment"],"mappings":"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","sourcesContent":["import './post.css';\nimport { MoreVert } from '@mui/icons-material';\nimport { useContext, useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { format } from \"timeago.js\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport { Link } from 'react-router-dom';\n\nexport default function Post({ post }) {\n    const [like, setLike] = useState(post.likes.length);\n    const [isLiked, setIsLiked] = useState(false);\n    const [user, setUser] = useState({});\n    const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n    const { user: currentUser } = useContext(AuthContext);\n  \n    useEffect(() => {\n      setIsLiked(post.likes.includes(currentUser._id));\n    }, [currentUser._id, post.likes]);\n  \n    useEffect(() => {\n      const fetchUser = async () => {\n        const res = await axios.get(`/users?userId=${post.userId}`);\n        setUser(res.data);\n      };\n      fetchUser();\n    }, [post.userId]);\n  \n    const likeHandler = () => {\n      try {\n        axios.put(\"/posts/\" + post._id + \"/like\", { userId: currentUser._id });\n      } catch (err) {}\n      setLike(isLiked ? like - 1 : like + 1);\n      setIsLiked(!isLiked);\n    };\n    return (\n      <div className=\"post\">\n        <div className=\"postWrapper\">\n          <div className=\"postTop\">\n            <div className=\"postTopLeft\">\n              <Link to={`/profile/${user.username}`}>\n                <img\n                  className=\"postProfileImg\"\n                  src={\n                    user.profilePicture\n                      ? PF + user.profilePicture\n                      : PF + \"person/noAvatar.png\"\n                  }\n                  alt=\"\"\n                />\n              </Link>\n              <span className=\"postUsername\">{user.username}</span>\n              <span className=\"postDate\">{format(post.createdAt)}</span>\n            </div>\n            <div className=\"postTopRight\">\n              <MoreVert />\n            </div>\n          </div>\n          <div className=\"postCenter\">\n            <span className=\"postText\">{post?.desc}</span>\n            <img className=\"postImg\" src={PF + post.img} alt=\"\" />\n          </div>\n          <div className=\"postBottom\">\n            <div className=\"postBottomLeft\">\n              <img\n                className=\"likeIcon\"\n                src={`${PF}like.png`}\n                onClick={likeHandler}\n                alt=\"\"\n              />\n              <img\n                className=\"likeIcon\"\n                src={`${PF}heart.png`}\n                onClick={likeHandler}\n                alt=\"\"\n              />\n              <span className=\"postLikeCounter\">{like} people like it</span>\n            </div>\n            <div className=\"postBottomRight\">\n              <span className=\"postCommentText\">{post.comment} comments</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }"]},"metadata":{},"sourceType":"module"}